<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.4">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-02-15T14:56:16-03:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">TinoUY</title><subtitle>Un sitio sobre sysadmins y tecnologia
</subtitle><author><name>Tino</name></author><entry><title type="html">FreeIPA - Crear grupo Read-only</title><link href="http://localhost:4000/2019/02/14/Free-IPA-Crear-grupo-read-only.html" rel="alternate" type="text/html" title="FreeIPA - Crear grupo Read-only" /><published>2019-02-14T00:00:00-03:00</published><updated>2019-02-14T00:00:00-03:00</updated><id>http://localhost:4000/2019/02/14/Free-IPA-Crear-grupo-read-only</id><content type="html" xml:base="http://localhost:4000/2019/02/14/Free-IPA-Crear-grupo-read-only.html">&lt;h3 id=&quot;para-que-queremos-un-grupo-de-read-only&quot;&gt;Para que queremos un grupo de Read-only?&lt;/h3&gt;

&lt;p&gt;Bueno, en el &lt;a href=&quot;/2019/02/08/Instalando-Free-IPA.html&quot;&gt;post anterior&lt;/a&gt; vimos como instalar FreeIPA y también comentamos que nos sirve para autenticar el acceso a diferentes servicios con FreeIPA, para ello vamos a crear un grupo de read-only en el cual crearemos un usuario para bindear y usar FreeIPA como autenticador de otros servicios.&lt;!-- more --&gt;&lt;/p&gt;

&lt;h3 id=&quot;que-necesitamos&quot;&gt;Que necesitamos?&lt;/h3&gt;

&lt;p&gt;Tener FreeIPA instalado y configurado como vimos &lt;a href=&quot;/2019/02/08/Instalando-Free-IPA.html&quot;&gt;aquí&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;agregar-nuevo-grupo-de-usuarios-read-only&quot;&gt;Agregar nuevo grupo de usuarios Read-only&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Lo primero es crear el grupo, para esto como siempre nos conectamos por ssh al FreeIPA y luego ejecutamos lo siguiente.
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa group-add readonly --desc &quot;A read-only group to bind LDAP authentication&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;La salida de este comando debe ser la siguiente (o muy parecida):&lt;/p&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;----------------------
Added group &quot;readonly&quot;
----------------------
  Group name: readonly
  Description: A read-only group to bind LDAP authentication
  GID: 836200003
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Crear el rol
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa role-add
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;Role name: read-only
----------------------
Added role &quot;read-only&quot;
----------------------
  Role name: read-only
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Crear privilegios
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa privilege-add
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;Privilege name: read-only
---------------------------
Added privilege &quot;read-only&quot;
---------------------------
  Privilege name: read-only
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Agregar los permisos
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa permission-add 'readonly' --targetgroup=readonly --permissions=read --attrs=member
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;---------------------------
Added permission &quot;readonly&quot;
---------------------------
  Permission name: readonly
  Granted rights: read
  Effective attributes: member
  Bind rule type: permission
  Subtree: dc=ipa,dc=tino,dc=uy
  Target DN: cn=readonly,cn=groups,cn=accounts,dc=ipa,dc=tino,dc=uy
  Target group: readonly
  Permission flags: SYSTEM, V2
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Asignamos
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa role-add-privilege read-only
``
```code
[privilege]: read-only
  Role name: read-only
  Privileges: read-only
----------------------------
Number of privileges added 1
----------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa privilege-add-permission
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;[permission]: readonly
  Privilege name: read-only
  Permissions: readonly
  Granting privilege to roles: read-only
-----------------------------
Number of permissions added 1
-----------------------------
&lt;/code&gt;&lt;/pre&gt;
    &lt;p&gt;Necesitamos usuario y contrasena de FreeIPA y crear el usuario viewonly en el panel del menu.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa role-add-member
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;Role name: read-only
[member user]: viewonly
[member group]:
[member host]:
[member host group]:
[member service]:
  Role name: read-only
  Member users: viewonly
  Privileges: read-only
-------------------------
Number of members added 1
-------------------------
&lt;/code&gt;&lt;/pre&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa group-add-member
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;Group name: readonly
[member user]: viewonly
[member group]:
  Group name: readonly
  Description: A read-only group to bind LDAP authentication
  GID: 836200003
  Member users: viewonly
-------------------------
Number of members added 1
-------------------------
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Listo, tenemos el grupo readonly creado y solo tiene permisos de lectura en el árbol del directorio de FreeIPA.&lt;/p&gt;</content><author><name>Tino</name><email>cmartinpf@gmail.com</email></author><summary type="html">Para que queremos un grupo de Read-only? Bueno, en el post anterior vimos como instalar FreeIPA y también comentamos que nos sirve para autenticar el acceso a diferentes servicios con FreeIPA, para ello vamos a crear un grupo de read-only en el cual crearemos un usuario para bindear y usar FreeIPA como autenticador de otros servicios. Que necesitamos? Tener FreeIPA instalado y configurado como vimos aquí. Agregar nuevo grupo de usuarios Read-only Lo primero es crear el grupo, para esto como siempre nos conectamos por ssh al FreeIPA y luego ejecutamos lo siguiente. ipa group-add readonly --desc &quot;A read-only group to bind LDAP authentication&quot; La salida de este comando debe ser la siguiente (o muy parecida): ---------------------- Added group &quot;readonly&quot; ---------------------- Group name: readonly Description: A read-only group to bind LDAP authentication GID: 836200003 Crear el rol ipa role-add Role name: read-only ---------------------- Added role &quot;read-only&quot; ---------------------- Role name: read-only Crear privilegios ipa privilege-add Privilege name: read-only --------------------------- Added privilege &quot;read-only&quot; --------------------------- Privilege name: read-only Agregar los permisos ipa permission-add 'readonly' --targetgroup=readonly --permissions=read --attrs=member --------------------------- Added permission &quot;readonly&quot; --------------------------- Permission name: readonly Granted rights: read Effective attributes: member Bind rule type: permission Subtree: dc=ipa,dc=tino,dc=uy Target DN: cn=readonly,cn=groups,cn=accounts,dc=ipa,dc=tino,dc=uy Target group: readonly Permission flags: SYSTEM, V2 Asignamos ipa role-add-privilege read-only `` ```code [privilege]: read-only Role name: read-only Privileges: read-only ---------------------------- Number of privileges added 1 ---------------------------- ipa privilege-add-permission [permission]: readonly Privilege name: read-only Permissions: readonly Granting privilege to roles: read-only ----------------------------- Number of permissions added 1 ----------------------------- Necesitamos usuario y contrasena de FreeIPA y crear el usuario viewonly en el panel del menu. ipa role-add-member Role name: read-only [member user]: viewonly [member group]: [member host]: [member host group]: [member service]: Role name: read-only Member users: viewonly Privileges: read-only ------------------------- Number of members added 1 ------------------------- ipa group-add-member Group name: readonly [member user]: viewonly [member group]: Group name: readonly Description: A read-only group to bind LDAP authentication GID: 836200003 Member users: viewonly ------------------------- Number of members added 1 ------------------------- Listo, tenemos el grupo readonly creado y solo tiene permisos de lectura en el árbol del directorio de FreeIPA.</summary></entry><entry><title type="html">Instalando FreeIPA</title><link href="http://localhost:4000/2019/02/08/Instalando-Free-IPA.html" rel="alternate" type="text/html" title="Instalando FreeIPA" /><published>2019-02-08T00:00:00-03:00</published><updated>2019-02-08T00:00:00-03:00</updated><id>http://localhost:4000/2019/02/08/Instalando-Free-IPA</id><content type="html" xml:base="http://localhost:4000/2019/02/08/Instalando-Free-IPA.html">&lt;h3 id=&quot;que-es-freeipa-free-identity-policy-audit&quot;&gt;Que es FreeIPA (Free Identity Policy Audit)?&lt;/h3&gt;

&lt;p&gt;Es un proyecto de suite de software de código fuente libre mantenida por el Proyecto Fedora, patrocinada por RedHat, el nombre significa Identidad Políticas Auditoría Libre (en inglés, Free Identity Policy Audit), tiene por objetivo proveer un interfaz segura y sencilla para la administración de identidades comparable a Novell Identity Manager, IBM Security Directory Suite, Redhat 389 Directory Server, Apache Directory Studio y Microsoft Active Directory.&lt;!-- more --&gt; &lt;a href=&quot;https://es.wikipedia.org/wiki/FreeIPA&quot;&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;para-que-queremos-un-freeipa&quot;&gt;Para que queremos un FreeIPA?&lt;/h4&gt;

&lt;p&gt;El FreeIPA nos sirve para manejar los usuarios de nuestra red de forma centralizada.
Seguramente habrás escuchado en algún momento de Active Directory o LDAP o Dominio a nivel de redes empresariales.
Pues lo que sucede es sencillo, en una red hogareña con dos o tres equipos es fácil administrar usuarios y permisos individuales en cada equipo ya que es una cantidad reducida, pero en una red con 50 equipos manejar usuarios y permisos equipo por equipo ya se vuelve algo tedioso, para esto se configura un servidor de Directorio Activo, se manejan todos los usuarios y grupos de forma centralizada en nuestro server de LDAP, Active Directory o FreeIPA. De esta forma agregar un usuario que puedan autenticarse en cualquier equipo, o darle permisos a un usuario para conectarse a determinado recurso compartido o impresora es mucho mas sencillo y puede hacerse desde un equipo y para toda la red.
Ademas podemos conectar otros tipos de servicios para que se autentiquen contra nuestro FreeIPA y que solo usuarios de nuestro dominio puedan acceder a estos servicios, pero esto ya lo veremos más adelante.&lt;/p&gt;

&lt;h3 id=&quot;que-necesitamos&quot;&gt;Que necesitamos?&lt;/h3&gt;

&lt;p&gt;Necesitamos un equipo con CentOS 7 en este caso sera virtualizado y la tarjeta de red estará en modo NAT.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ethernet: ens33&lt;br /&gt;
IP: 172.16.121.136&lt;br /&gt;
Hostname: ipa.tino.uy&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;configuración-previa&quot;&gt;Configuración previa&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;Para esto vamos a configurar el CentOS 7, nos conectamos por ssh
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh root@172.16.121.136
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Y borramos el contenido del archivo &lt;em&gt;/etc/hostname&lt;/em&gt; y colocamos el nombre fqdn que querramos para nuestro LDAP
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa.tino.uy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Luego editamos el archivo &lt;em&gt;/etc/hosts/&lt;/em&gt;, lo mismo que antes
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;172.16.121.136 ipa.tino.uy ipa.tino.uy ipa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Configuración de firewall
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;firewall-cmd --permanent --add-port={80/tcp,443/tcp,389/tcp,636/tcp,88/tcp,464/tcp,53/tcp,88/udp,464/udp,53/udp,123/udp}
firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Luego reiniciamos el centos con &lt;em&gt;reboot&lt;/em&gt; y volvemos a conectarnos por ssh (ver paso 1)&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;configurando-el-generador-de-números-aleatorios&quot;&gt;Configurando el Generador de Números Aleatorios&lt;/h3&gt;

&lt;p&gt;Configurar un FreeIPA requiere de un montón de datos aleatorios para las operaciones criptográficas que corre. Por defecto una maquina virtual se queda sin datos aleatorios o entropía muy rápidamente. Para solucionar esto usaremos &lt;strong&gt;&lt;em&gt;rngd&lt;/em&gt;&lt;/strong&gt;, un software generador de números aleatorios.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Debemos instalar &lt;strong&gt;&lt;em&gt;rngd&lt;/em&gt;&lt;/strong&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum install rng-tools
systemctl start rngd
systemctl enable rngd
systemctl status rngd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;La salida debe incluir active (running) en verde.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;instalando-freeipa&quot;&gt;Instalando FreeIPA&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Ahora si, instalamos el paquete ipa-server.
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum install ipa-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Ejecutar el comando de instalación.
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa-server-install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Prompt de la instalación.
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;Do you want to configure integrated DNS (BIND)? [no]: no  
Server host name [ipa.tino.uy]: ipa.tino.uy  
Please confirm the domain name [tino.uy]: ipa.tino.uy  
Please provide a realm name [IPA.TINO.UY]: ipa.tino.uy  
Directory Manager password:  
IPA admin password:  
Continue to configure the system with these values? [no]: yes  
&lt;/code&gt;&lt;/pre&gt;
    &lt;p&gt;El proceso de instalación llevará unos minutos.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;verificar-las-funciones-de-freeipa&quot;&gt;Verificar las funciones de FreeIPA&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Primero debemos verificar que el dominio de Kerberos fue instalado correctamente intentando inicializar el token de Kerberos para el usuario admin.
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kinit admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;Si funciona correctamente entonces debería pedirte la contraseña de admin de FreeIPA que escribimos hace unos minutos.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Verificar que el servidor IPA funciona adecuadamente.
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipa user-find admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;La salida de este comando debería ser la siguiente.&lt;/p&gt;
    &lt;pre&gt;&lt;code class=&quot;language-code&quot;&gt;---------------------
1 usuario coincidente
---------------------
  Ingreso de usuario: admin
  Apellido: Administrator
  Directorio principal: /home/admin
  Shell de ingreso: /bin/bash
  Principal alias: admin@IPA.TINO.UY
  UID: 836200000
  GID: 836200000
  Cuenta inhabilitada : False
--------------------------------
Cantidad de entradas devueltas 1
--------------------------------
&lt;/code&gt;&lt;/pre&gt;
    &lt;p&gt;También tendremos acceso a una interfaz web en https://ipa.tino.uy&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Y voilá, tenemos FreeIPA instalado y listo para usar.&lt;/p&gt;</content><author><name>Tino</name><email>cmartinpf@gmail.com</email></author><summary type="html">Que es FreeIPA (Free Identity Policy Audit)? Es un proyecto de suite de software de código fuente libre mantenida por el Proyecto Fedora, patrocinada por RedHat, el nombre significa Identidad Políticas Auditoría Libre (en inglés, Free Identity Policy Audit), tiene por objetivo proveer un interfaz segura y sencilla para la administración de identidades comparable a Novell Identity Manager, IBM Security Directory Suite, Redhat 389 Directory Server, Apache Directory Studio y Microsoft Active Directory. Wikipedia Para que queremos un FreeIPA? El FreeIPA nos sirve para manejar los usuarios de nuestra red de forma centralizada. Seguramente habrás escuchado en algún momento de Active Directory o LDAP o Dominio a nivel de redes empresariales. Pues lo que sucede es sencillo, en una red hogareña con dos o tres equipos es fácil administrar usuarios y permisos individuales en cada equipo ya que es una cantidad reducida, pero en una red con 50 equipos manejar usuarios y permisos equipo por equipo ya se vuelve algo tedioso, para esto se configura un servidor de Directorio Activo, se manejan todos los usuarios y grupos de forma centralizada en nuestro server de LDAP, Active Directory o FreeIPA. De esta forma agregar un usuario que puedan autenticarse en cualquier equipo, o darle permisos a un usuario para conectarse a determinado recurso compartido o impresora es mucho mas sencillo y puede hacerse desde un equipo y para toda la red. Ademas podemos conectar otros tipos de servicios para que se autentiquen contra nuestro FreeIPA y que solo usuarios de nuestro dominio puedan acceder a estos servicios, pero esto ya lo veremos más adelante. Que necesitamos? Necesitamos un equipo con CentOS 7 en este caso sera virtualizado y la tarjeta de red estará en modo NAT. Ethernet: ens33 IP: 172.16.121.136 Hostname: ipa.tino.uy Configuración previa Para esto vamos a configurar el CentOS 7, nos conectamos por ssh ssh root@172.16.121.136 Y borramos el contenido del archivo /etc/hostname y colocamos el nombre fqdn que querramos para nuestro LDAP ipa.tino.uy Luego editamos el archivo /etc/hosts/, lo mismo que antes 172.16.121.136 ipa.tino.uy ipa.tino.uy ipa Configuración de firewall firewall-cmd --permanent --add-port={80/tcp,443/tcp,389/tcp,636/tcp,88/tcp,464/tcp,53/tcp,88/udp,464/udp,53/udp,123/udp} firewall-cmd --reload Luego reiniciamos el centos con reboot y volvemos a conectarnos por ssh (ver paso 1) Configurando el Generador de Números Aleatorios Configurar un FreeIPA requiere de un montón de datos aleatorios para las operaciones criptográficas que corre. Por defecto una maquina virtual se queda sin datos aleatorios o entropía muy rápidamente. Para solucionar esto usaremos rngd, un software generador de números aleatorios. Debemos instalar rngd yum install rng-tools systemctl start rngd systemctl enable rngd systemctl status rngd La salida debe incluir active (running) en verde. Instalando FreeIPA Ahora si, instalamos el paquete ipa-server. yum install ipa-server Ejecutar el comando de instalación. ipa-server-install Prompt de la instalación. Do you want to configure integrated DNS (BIND)? [no]: no Server host name [ipa.tino.uy]: ipa.tino.uy Please confirm the domain name [tino.uy]: ipa.tino.uy Please provide a realm name [IPA.TINO.UY]: ipa.tino.uy Directory Manager password: IPA admin password: Continue to configure the system with these values? [no]: yes El proceso de instalación llevará unos minutos. Verificar las funciones de FreeIPA Primero debemos verificar que el dominio de Kerberos fue instalado correctamente intentando inicializar el token de Kerberos para el usuario admin. kinit admin Si funciona correctamente entonces debería pedirte la contraseña de admin de FreeIPA que escribimos hace unos minutos. Verificar que el servidor IPA funciona adecuadamente. ipa user-find admin La salida de este comando debería ser la siguiente. --------------------- 1 usuario coincidente --------------------- Ingreso de usuario: admin Apellido: Administrator Directorio principal: /home/admin Shell de ingreso: /bin/bash Principal alias: admin@IPA.TINO.UY UID: 836200000 GID: 836200000 Cuenta inhabilitada : False -------------------------------- Cantidad de entradas devueltas 1 -------------------------------- También tendremos acceso a una interfaz web en https://ipa.tino.uy Y voilá, tenemos FreeIPA instalado y listo para usar.</summary></entry><entry><title type="html">Instalando DRBD</title><link href="http://localhost:4000/2018/01/19/Instalando-DRBD.html" rel="alternate" type="text/html" title="Instalando DRBD" /><published>2018-01-19T00:00:00-03:00</published><updated>2018-01-19T00:00:00-03:00</updated><id>http://localhost:4000/2018/01/19/Instalando-DRBD</id><content type="html" xml:base="http://localhost:4000/2018/01/19/Instalando-DRBD.html">&lt;p&gt;Bienvenidos aventureros.
En este post vamos a aprender a instalar DRBD. &lt;!-- more --&gt;.
En cada nodo tendremos un disco vacio y completamente dedicado a DRBD, por lo tanto usaremos este disco /dev/vda&lt;/p&gt;

&lt;h3 id=&quot;que-es-drbd-distributed-replicated-block-device&quot;&gt;Que es DRBD (Distributed Replicated Block Device)?&lt;/h3&gt;

&lt;p&gt;DRBD es un software que permite hacer replica de los datos de una particion o disco entre varias maquinas a traves de la red.&lt;/p&gt;

&lt;h3 id=&quot;entorno&quot;&gt;Entorno&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;table&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Nodo1&lt;/td&gt;
        &lt;td&gt;drbd1&lt;/td&gt;
        &lt;td&gt;192.168.10.10&lt;/td&gt;
        &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;

  &lt;table&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Nodo2&lt;/td&gt;
        &lt;td&gt;drbd2&lt;/td&gt;
        &lt;td&gt;192.168.10.11&lt;/td&gt;
        &lt;td&gt;CentOS 7&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;instalando&quot;&gt;Instalando&lt;/h3&gt;
&lt;p&gt;Para comenzar con la instalación lo primero que haremos sera ir a una terminal de linux.
1 - Ejecutaremos los siguientes comandos para agregar el repositorio ELRepo en ambos nodos:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
# rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2 - Luego ejecutamos lo siguiente para instalar DRBD y los modulos del kernel necesarios para el funcionamiento de DRBD:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum install drbd90-utils kmod-drbd90
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cuando finalice la instalación comprobaremos si el modulo del kernel fue cargado:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lsmod | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; drbd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Si no fue cargado automáticamente entonces ejecutamos:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;modprobe drbd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Nota&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;El comando modprobe cargara el modulo durante la sesión activa, para que el modulo se cargue en el inicio hay que utilizar el servicio &lt;strong&gt;systemd-modules-load&lt;/strong&gt; creando un archivo dentro de &lt;strong&gt;/etc/modulesload.d/&lt;/strong&gt; y de esta manera el modulo es cargado durante cada inicio del sistema.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;drbd &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modules-load.d/drbd.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;configurando-drbd&quot;&gt;Configurando DRBD&lt;/h3&gt;
&lt;p&gt;Luego de instalar DRBD de forma correcta lo que haremos sera cambiar la configuración global editando el archivo &lt;strong&gt;/etc/drbd.d/global_common.conf&lt;/strong&gt;
1 - Vamos a hacer un backup del archivo original:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mv /etc/drbd.d/global_common.conf /etc/drbd.d/global_common.conf.orig
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2 - Creamos un nuevo archivo de configuración global:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vi /etc/drbd.d/global_common.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;global {
 usage-count no;
}
common {
 net {
  protocol C;
 }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3 - Lo siguiente sera crear un archivo de configuración para el recurso &lt;strong&gt;drbd0&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vi /etc/drbd.d/drbd0.res
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource drbd0 {
	disk /dev/vda;
	device /dev/drbd0;
	meta-disk internal;
	on drbd1 {
		address 192.168.10.10:7789;
	}
	on drbd2 {
		address 192.168.10.11:7789;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Nota&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;En el archivo de recurso de arriba hemos creado un nuevo recurso llamado drbd0, donde 192.168.10.10 y 192.168.10.11 son las IP de nuestros nodos y 7789 el puerto utilizado para la comunicación, usando el disco /dev/vda para crear el dispositivo /dev/drbd0.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;4 - Inicializar el dispositivo drbd0 en cada nodo:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm create-md drbd0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5 - Iniciar y habilitar el demonio drbd en ambos nodos:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systemctl start drbd
systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;drbd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;6 - Definamos el Nodo1 como nodo primario:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm up drbd0
drbdadm primary drbd0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Nota&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;En caso de tener algún error para definir el nodo como primaro ejecutamos el mismo comando pero con el parámetro –force para forzar esta opcion.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm primary drbd &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;7 - Para chequear el estado de la sincronización mientras se ejecuta utilizamos el siguiente comando:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;8 - Ajustes de firewall en ambos nodos:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;firewall-cmd &lt;span class=&quot;nt&quot;&gt;--permanent&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--add-rich-rule&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'rule family=&quot;ipv4&quot; source address=&quot;ip_nodo&quot; port port=&quot;7789&quot; protocol=&quot;tcp&quot; accept'&lt;/span&gt;
firewall-cmd &lt;span class=&quot;nt&quot;&gt;--reload&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;testeando-drbd&quot;&gt;Testeando DRBD&lt;/h3&gt;

&lt;p&gt;Para testear DRBD crearemos un filesystem, montaremos el volumen y crearemos archivos en el nodo primario &lt;em&gt;drbd1&lt;/em&gt;, finalmente cambiaremos el nodo primario a &lt;em&gt;drbd2&lt;/em&gt; y comprobaremos que DRBD funciona.
Con el siguiente comando crearemos un filesystem xfs en /dev/drbd0 y lo montaremos en /mnt/&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkfs.xfs /dev/drbd0
mount /dev/drbd0 /mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Crearemos archivos con&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;touch /mnt/file&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1..5&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; /mnt/
total 0
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file1
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file2
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file3
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file4
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora cambiaremos el nodo primario de &lt;em&gt;drbd1&lt;/em&gt; a &lt;em&gt;drbd2&lt;/em&gt;
Primero desmontamos el volumen drbd0&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;umount /mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cambiamos el Nodo1 de primario a secundario&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm secondary drbd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora cambiamos el Nodo2 de secundario a primario&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drbdadm primary drbd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Montamos el filesystem y comprobamos que tenga los archivos dentro&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mount /dev/drbd0 /mnt
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;  /mnt
total 0
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file1
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file2
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file3
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file4
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root root 0 Sep 22 21:43 file5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Tino</name><email>cmartinpf@gmail.com</email></author><summary type="html">Bienvenidos aventureros. En este post vamos a aprender a instalar DRBD. . En cada nodo tendremos un disco vacio y completamente dedicado a DRBD, por lo tanto usaremos este disco /dev/vda Que es DRBD (Distributed Replicated Block Device)? DRBD es un software que permite hacer replica de los datos de una particion o disco entre varias maquinas a traves de la red. Entorno Nodo1 drbd1 192.168.10.10 CentOS 7 Nodo2 drbd2 192.168.10.11 CentOS 7 Instalando Para comenzar con la instalación lo primero que haremos sera ir a una terminal de linux. 1 - Ejecutaremos los siguientes comandos para agregar el repositorio ELRepo en ambos nodos: # rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org # rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm 2 - Luego ejecutamos lo siguiente para instalar DRBD y los modulos del kernel necesarios para el funcionamiento de DRBD: yum install drbd90-utils kmod-drbd90 Cuando finalice la instalación comprobaremos si el modulo del kernel fue cargado: lsmod | grep -i drbd Si no fue cargado automáticamente entonces ejecutamos: modprobe drbd Nota El comando modprobe cargara el modulo durante la sesión activa, para que el modulo se cargue en el inicio hay que utilizar el servicio systemd-modules-load creando un archivo dentro de /etc/modulesload.d/ y de esta manera el modulo es cargado durante cada inicio del sistema. echo drbd &amp;gt; /etc/modules-load.d/drbd.conf Configurando DRBD Luego de instalar DRBD de forma correcta lo que haremos sera cambiar la configuración global editando el archivo /etc/drbd.d/global_common.conf 1 - Vamos a hacer un backup del archivo original: mv /etc/drbd.d/global_common.conf /etc/drbd.d/global_common.conf.orig 2 - Creamos un nuevo archivo de configuración global: vi /etc/drbd.d/global_common.conf global { usage-count no; } common { net { protocol C; } } 3 - Lo siguiente sera crear un archivo de configuración para el recurso drbd0: vi /etc/drbd.d/drbd0.res resource drbd0 { disk /dev/vda; device /dev/drbd0; meta-disk internal; on drbd1 { address 192.168.10.10:7789; } on drbd2 { address 192.168.10.11:7789; } } Nota En el archivo de recurso de arriba hemos creado un nuevo recurso llamado drbd0, donde 192.168.10.10 y 192.168.10.11 son las IP de nuestros nodos y 7789 el puerto utilizado para la comunicación, usando el disco /dev/vda para crear el dispositivo /dev/drbd0. 4 - Inicializar el dispositivo drbd0 en cada nodo: drbdadm create-md drbd0 5 - Iniciar y habilitar el demonio drbd en ambos nodos: systemctl start drbd systemctl enable drbd 6 - Definamos el Nodo1 como nodo primario: drbdadm up drbd0 drbdadm primary drbd0 Nota En caso de tener algún error para definir el nodo como primaro ejecutamos el mismo comando pero con el parámetro –force para forzar esta opcion. drbdadm primary drbd --force 7 - Para chequear el estado de la sincronización mientras se ejecuta utilizamos el siguiente comando: drbdadm status 8 - Ajustes de firewall en ambos nodos: firewall-cmd --permanent --add-rich-rule='rule family=&quot;ipv4&quot; source address=&quot;ip_nodo&quot; port port=&quot;7789&quot; protocol=&quot;tcp&quot; accept' firewall-cmd --reload Testeando DRBD Para testear DRBD crearemos un filesystem, montaremos el volumen y crearemos archivos en el nodo primario drbd1, finalmente cambiaremos el nodo primario a drbd2 y comprobaremos que DRBD funciona. Con el siguiente comando crearemos un filesystem xfs en /dev/drbd0 y lo montaremos en /mnt/ mkfs.xfs /dev/drbd0 mount /dev/drbd0 /mnt Crearemos archivos con touch /mnt/file{1..5} ls -l /mnt/ total 0 -rw-r--r--. 1 root root 0 Sep 22 21:43 file1 -rw-r--r--. 1 root root 0 Sep 22 21:43 file2 -rw-r--r--. 1 root root 0 Sep 22 21:43 file3 -rw-r--r--. 1 root root 0 Sep 22 21:43 file4 -rw-r--r--. 1 root root 0 Sep 22 21:43 file5 Ahora cambiaremos el nodo primario de drbd1 a drbd2 Primero desmontamos el volumen drbd0 umount /mnt Cambiamos el Nodo1 de primario a secundario drbdadm secondary drbd Ahora cambiamos el Nodo2 de secundario a primario drbdadm primary drbd Montamos el filesystem y comprobamos que tenga los archivos dentro mount /dev/drbd0 /mnt ls -l /mnt total 0 -rw-r--r--. 1 root root 0 Sep 22 21:43 file1 -rw-r--r--. 1 root root 0 Sep 22 21:43 file2 -rw-r--r--. 1 root root 0 Sep 22 21:43 file3 -rw-r--r--. 1 root root 0 Sep 22 21:43 file4 -rw-r--r--. 1 root root 0 Sep 22 21:43 file5</summary></entry><entry><title type="html">Hola Mundo!</title><link href="http://localhost:4000/2018/01/03/hola-mundo.html" rel="alternate" type="text/html" title="Hola Mundo!" /><published>2018-01-03T00:00:00-03:00</published><updated>2018-01-03T00:00:00-03:00</updated><id>http://localhost:4000/2018/01/03/hola-mundo</id><content type="html" xml:base="http://localhost:4000/2018/01/03/hola-mundo.html">&lt;p&gt;Hola mundo! Este es mi blog con Jekyll, ahora no hay más excusas para no tener un blog o documentación!&lt;/p&gt;</content><author><name>Tino</name><email>cmartinpf@gmail.com</email></author><summary type="html">Hola mundo! Este es mi blog con Jekyll, ahora no hay más excusas para no tener un blog o documentación!</summary></entry></feed>